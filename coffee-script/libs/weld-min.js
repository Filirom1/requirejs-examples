/* Weld */
(function(a){if(!Object.keys){var b=!0,c=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],d=c.length;for(var e in{toString:null})b=!1;Object.keys=function r(a){if(typeof a!="object"&&typeof a!="function"||a===null)throw new TypeError("Object.keys called on a non-object");var r=[];for(var e in a)a.hasOwnProperty(e)&&r.push(e);if(b)for(var f=0,g=d;f<g;f++){var h=c[f];a.hasOwnProperty(h)&&r.push(h)}return r}}var f=typeof console=="undefined"?{log:function(){}}:console,g=!1;typeof process!="undefined"&&process.title&&(g=!0);var h={gray:"[37m",darkgray:"[40;30m",red:"[31m",green:"[32m",yellow:"[33m",lightblue:"[1;34m",cyan:"[36m",white:"[1;37m"},i=/input|select|textarea|option|button/i,j=/img/i,k=0,l=g?h.green+" âœ“"+h.gray:" Success",m=g?h.red+" âœ—"+h.gray:" Fail",n=function(a,b){var c=a.toUpperCase();return function(a,d,e,i){f.log(o(),(g?h.gray+"â”Œ ":"+ ")+c+" -","parent:",q(a)+",","element:",q(d)+",","key:",q(e)+",","value:",q(i)),k+=1;if(b){var j=b(a,d,e,i);return k-=1,f.log(o(),(g?"â”” ":"+ ")+d+""+(j!==!1?l:m)),j}k-=1,p("- OPERATION NOT FOUND: ",c)}},o=function(){var a=k,b="";while(a--)b+=g?" â”‚   ":" |   ";return b},p=function(){var a=Array.prototype.slice.call(arguments);f.log(o(),a.join(" "))},q=function(a){var b=a+"",c="undefined";return g?b==="false"||b==="null"||b===""||b===c||typeof a===c||a===!1?(b===""&&(b="(empty string)"),h.red+b+h.gray):h.yellow+b+h.gray:b};a.weld=function(a,b,c){var d=a.parentNode,e,g,h,k,l={alias:{},debug:!1,insert:!1};if(c)for(g in c)c.hasOwnProperty(g)&&(l[g]=c[g]);k=l.debug;var m={siblings:function o(a,b,c,d){var e=[],f,g,h,i,o=a.children;cs=o.length,b.weld={parent:a,classes:b.className.split(" ")};while(cs--){f=o[cs];if(f===b)cs<o.length&&(b.weld.insertBefore=o[cs+1]),k&&p("- REMOVE - element:",q(b),"class:",q(b.className),"id:",q(b.id)),a.removeChild(b);else{g=f.className.split(" "),h=g.length,i=!0;while(h--)if(b.weld.classes.indexOf(g[h])<0){i=!1;break}i&&(k&&p("- REMOVE - element:",q(f),"class:",q(f.className),"id:",q(f.id)),a.removeChild(f))}}},traverse:function r(a,b,c,d){var e,f,g,h,i,j,l=b,n=b.parentNode;~{}.toString.call(d).indexOf("Date")&&(d=d.toString());if(d.nodeType||typeof d!="object")m.set(a,b,c,d);else if(d.length&&d[0]){n?m.siblings(n,l,c,d):l.weld&&l.weld.parent&&(n=l.weld.parent),i=d.length;for(g=0;g<i;g++){k&&p("- CLONE - element:",q(b),"class:",q(b.className),"id:",q(b.id)),f=b.cloneNode(!0),f.weld={};if(b.weld){var h=Object.keys(b.weld),o=h.length,r;while(o--)r=h[o],f.weld[r]=b.weld[r]}m.traverse(n,f,g,d[g]),m.insert(n,f,g,d[g])}}else{var h=Object.keys(d),s=h.length,j;while(s--){var t=h[s];j=d[t],f=m.match(l,b,t,j),f?m.traverse(l,f,t,j):f!==!1&&typeof j=="object"&&Object.keys(j).length>0&&m.traverse(n,l,t,j)}}},elementType:function(a,b,c,d){if(b){var e=b.nodeName;if(typeof e=="string"){if(i.test(e))return"input";if(j.test(e))return"image"}}},map:!1,insert:function(a,b){b.weld&&b.weld.insertBefore?a.insertBefore(b,b.weld.insertBefore):a.appendChild(b)},set:function(a,b,c,d){if(m.map&&m.map(a,b,c,d)===!1)return!1;k&&p("- SET: value is",d.tagName);var e=m.elementType(a,b,c,d),f=!1;if(d&&d.nodeType){b.ownerDocument!==d.ownerDocument?d=b.ownerDocument.importNode(d,!0):d.parentNode&&d.parentNode.removeChild(d);while(b.firstChild)b.removeChild(b.firstChild);b.appendChild(d),f=!0}else e==="input"?(b.setAttribute("value",d),f=!0):e==="image"?(b.setAttribute("src",d),f=!0):(b.textContent=d,f=!0);return f},match:function(a,b,c,d){if(typeof l.alias[c]!="undefined")if(typeof l.alias[c]=="function")c=l.alias[c](a,b,c,d)||c;else{if(l.alias[c]===!1)return!1;c=l.alias[c]}if(c&&c.nodeType)return c;if(b){if(b.querySelector)return b.querySelector("."+c+",#"+c+',[name="'+c+'"]');var e=b.getElementsByTagName("*"),f=e.length,g,h;for(h=0;h<f;h++){g=e[h];if(g.id===c||g.name===c||g.className.split(" ").indexOf(c)>-1)return g}}}};for(e in m)m.hasOwnProperty(e)&&(currentOp=m[e],h=l[e]||m[e],k&&(h=n(e,h)),m[e]=h);m.traverse(null,a,null,b),l.debug&&f.log(a.outerHTML)},typeof a.define!="undefined"&&a.define.amd&&define("weld",[],function(){return window.weld})})(typeof exports=="undefined"?window:exports);
