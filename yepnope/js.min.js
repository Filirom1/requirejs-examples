/**
 * curl js plugin
 *
 * (c) copyright 2011, unscriptable.com / John Hann
 * Licensed under the MIT License at:
 * 		http://www.opensource.org/licenses/mit-license.php
 *
 * usage:
 *  require(['ModuleA', 'js!myNonAMDFile.js!order', 'js!anotherFile.js!order], function (ModuleA) {
 * 		var a = new ModuleA();
 * 		document.body.appendChild(a.domNode);
 * 	});
 *
 * Specify the !order suffix for files that must be evaluated in order.
 *
 * Async=false rules learned from @getify's LABjs!
 * http://wiki.whatwg.org/wiki/Dynamic_Script_Execution_Order
 *
 */(function(global,doc){function loadScript(a,b,c){function f(c){c=c||global.event;if(c.type=="load"||readyStates[e.readyState])e.onload=e[orsc]=e.onerror="",!a.test||testGlobalVar(a.test)?b(e):g()}function g(b){e.onload=e[orsc]=e.onerror="",c&&c(new Error("Script error or http error: "+a.url))}function h(){e.onload&&readyStates[e.readyState]?f({}):e.onload&&d<new Date?g():setTimeout(h,10)}var d,e;d=(new Date).valueOf()+(a.timeout||300)*1e3,e=doc.createElement("script"),c&&a.test&&setTimeout(h,10),e.type=a.mimetype||"text/javascript",e.onload=e[orsc]=f,e.onerror=g,e.charset=a.charset||"utf-8",e.async=a.async,e.src=a.url,head.insertBefore(e,head.firstChild)}function fetch(a,b){loadScript(a,function(a){var c=queue.shift();waitForOrderedScript=queue.length>0,c&&fetch.apply(null,c),b.resolve(a)},function(a){b.reject(a)})}function testGlobalVar(varName){try{return eval("global."+varName),!0}catch(ex){return!1}}"use strict";var queue=[],supportsAsyncFalse=doc.createElement("script").async==1,readyStates={loaded:1,interactive:1,complete:1},orsc="onreadystatechange",head=doc.head||doc.getElementsByTagName("head")[0],waitForOrderedScript;define({load:function(a,b,c,d){var e,f,g,h,i,j;e=a.indexOf("!order")>0,f=a.indexOf("!test="),g=f>0&&a.substr(f+6),h="prefetch"in d?d.prefetch:!0,a=e||f>0?a.substr(0,a.indexOf("!")):a,i={name:a,url:b.toUrl(a),async:!e,order:e,test:g,timeout:d.timeout},j=c.resolve?c:{resolve:function(a){c(a)},reject:function(a){throw a}},e&&!supportsAsyncFalse&&waitForOrderedScript?(queue.push([i,j]),h&&(i.mimetype="text/cache",loadScript(i,function(a){a.parentNode.removeChild(a)},!1),i.mimetype="")):(waitForOrderedScript=waitForOrderedScript||e,fetch(i,j))}})})(this,document);